# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

name: Build CMake

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  build:
    defaults:
      run:
        shell: cmd
    runs-on: windows-2022

    steps:
    - uses: actions/checkout@v4

    - name: Install winget
      uses: Cyberboss/install-winget@v1

    - name: setup visual studio
      run: .\tools\setup_vs.cmd
      shell: cmd /c {0}

    - name: build
      run: |
        "%ProgramFiles(x86)%\Microsoft Visual Studio\2022\BuildTools\Common7\Tools\VsDevCmd.bat"
        .\tools\build.cmd
      shell: cmd /c {0}
